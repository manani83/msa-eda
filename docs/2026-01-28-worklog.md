# 작업 내역 정리 (2026-01-28)

## 개요
오늘 진행한 작업은 스프링부트(Gradle) 기반의 헥사고날 아키텍처 프로젝트 구성과, H2 DB 연동, 간단한 웹 API 및 테스트, 그리고 패키지 구조 조정과 주문(Order) 도메인 추가까지 포함합니다. 아래는 순서대로 정리한 상세 내용입니다.

---

## 1. 프로젝트 기본 구성

### 1) Gradle 기반 Spring Boot 프로젝트 구성
- `build.gradle`에 다음 의존성을 추가
  - `spring-boot-starter-web`
  - `spring-boot-starter-data-jpa`
  - `com.h2database:h2`
- Java 17 툴체인 설정
- 테스트용 `spring-boot-starter-test` 추가

### 2) 애플리케이션 엔트리 생성
- `HexagonalApiApplication` 생성
  - Spring Boot 실행 엔트리

### 3) H2 DB 설정
- `application.yml`에 H2 메모리 DB 설정 추가
  - `jdbc:h2:mem:testdb`
  - `ddl-auto: create-drop`
  - H2 콘솔 활성화 `/h2-console`

---

## 2. 헥사고날 아키텍처 기반 Hello API 구성

### 1) 도메인 계층
- `GreetingMessage` 도메인 모델 추가

### 2) 애플리케이션 계층
- `GreetingUseCase` 인터페이스 생성
- `GreetingService` 구현체 생성
  - `hello world` 반환
  - 호출 시 DB 저장 로직 포함(아웃바운드 포트 사용)

### 3) 인바운드 어댑터(웹)
- `GreetingController`
  - `GET /hello` 요청 시 `hello world` 반환

### 4) 아웃바운드 어댑터(JPA)
- `GreetingRecord` 저장용 포트 및 어댑터 추가
  - `GreetingRecordPort`
  - `GreetingRecordQueryPort`
  - JPA 엔티티 `GreetingRecordEntity`
  - Spring Data JPA Repository
  - Persistence Adapter

### 5) 조회 API 추가
- `GET /greetings` 추가
  - 저장된 메시지를 JSON 배열로 반환

---

## 3. 테스트 추가

### 1) 유스케이스 테스트
- `GreetingServiceTest`
  - hello world 반환 + 저장 호출 검증

### 2) 컨트롤러 테스트
- `GreetingControllerTest`
  - `/hello` 응답 검증
  - `/greetings` 응답 JSON 검증

### 3) 영속성 어댑터 통합 테스트
- `GreetingRecordPersistenceAdapterTest`
  - 저장 후 조회 성공 검증

### 4) 콘솔 출력 테스트
- `HelloWorldConsoleTest`
  - 테스트 실행 시 콘솔에 `hello world` 출력

---

## 4. 패키지 구조 변경

### 변경 전
- `adapters/inbound`
- `adapters/outbound`

### 변경 후
- `adapters/in`
- `adapters/out`

### 영향 범위
- 패키지 선언 변경 및 디렉터리 이동
  - `GreetingController`
  - `GreetingControllerTest`
  - `GreetingRecordEntity`
  - `GreetingRecordJpaRepository`
  - `GreetingRecordPersistenceAdapter`
  - `GreetingRecordPersistenceAdapterTest`

---

## 5. Gradle Wrapper 설정 및 테스트 실행

### 1) 문제 발생
- `gradle test` 실행 시 Mac x86_64 native lib 로딩 실패
- `./gradlew test` 실행 시 wrapper JAR 불일치로 클래스 누락

### 2) 해결
- Gradle 8.5 배포판 다운로드
- `gradle wrapper --gradle-version 8.5` 실행 완료
- 정상적인 wrapper 파일 재생성

### 3) 테스트 실행 결과
- `./gradlew test` 성공
- 빌드 성공 로그 확인

---

## 6. Order 도메인 추가 (MSA 분리 고려 구조)

### 1) 도메인 모델
- `Order`, `OrderItem`, `OrderStatus`
- `Money`, `Address`
- 주문 생성 시 총합 계산 및 유효성 검증

### 2) 애플리케이션 계층
- `CreateOrderUseCase`
- `CreateOrderCommand`
- `CreateOrderResult`
- `CreateOrderService`

### 3) 포트
- `OrderCommandPort` (저장 책임)

### 4) 웹 어댑터
- `POST /orders` API 구현
- 요청 DTO: `CreateOrderRequest`
- 응답 DTO: `CreateOrderResponse`

### 5) 영속성 어댑터
- `OrderEntity`, `OrderItemEntity`
- `OrderJpaRepository`
- `OrderPersistenceAdapter`

---

## 7. API 요약

### Hello API
- `GET /hello` → `hello world`
- `GET /greetings` → 저장된 메시지 목록

### Order API
- `POST /orders`
  - 주문 생성
  - 응답에 주문 ID/상태/총액/생성일 반환

---

## 참고
- 테스트 실행은 Gradle Wrapper 기준으로 성공 확인
- H2 Console: `/h2-console` 사용 가능
- 현재 구조는 MSA 전환을 고려한 도메인 단위 모듈 구조를 기반으로 설계

